import{c as _,b as l,j as s,B as j,n as b,I as z,o as M,q as R,X as B,C as F,k as C,p as S,R as K}from"./Spinner-DHCKR5Oc.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],O=_("Sparkles",A),T=({value:e,onChange:i,onKeyDown:d,placeholder:p="Enter category...",categories:x,aiSuggestion:a,className:u=""})=>{const[t,c]=l.useState(e),[h,m]=l.useState(!1),[r,o]=l.useState(!1),f=l.useRef(null);l.useEffect(()=>{a&&!h&&!e&&(c(a),i(a),m(!0))},[a,h,e,i]),l.useEffect(()=>{e!==t&&document.activeElement!==f.current&&c(e)},[e]),l.useEffect(()=>{o(!a&&!t?!1:t!==a)},[a,t]);const k=n=>{const y=n.target.value;c(y),i(y)},I=n=>{var y;if(n.key==="Tab"&&t){const g=x.find(w=>w.toLowerCase().startsWith(t.toLowerCase())&&w.toLowerCase()!==t.toLowerCase());if(g){n.preventDefault(),c(g),i(g);return}}if(n.key==="Escape"&&a&&t===a){o(!1),(y=f.current)==null||y.blur();return}d&&d(n)},E=n=>{n.target.select()},L=()=>{o(!0),setTimeout(()=>{var n;(n=f.current)==null||n.focus()},0)},N=()=>{a&&t===a&&o(!1)},v=t?x.find(n=>n.toLowerCase().startsWith(t.toLowerCase())&&n.toLowerCase()!==t.toLowerCase()):null;return s.jsx("div",{className:`relative ${u}`,children:r?s.jsxs("div",{className:"relative",children:[v&&s.jsxs("div",{className:"absolute inset-0 px-3 py-2 text-sm text-gray-400 pointer-events-none bg-transparent border border-transparent rounded-md",style:{zIndex:1},children:[s.jsx("span",{className:"invisible",children:t}),s.jsx("span",{children:v.slice(t.length)})]}),s.jsx(z,{ref:f,type:"text",value:t,onChange:k,onKeyDown:I,onFocus:E,onBlur:N,placeholder:p,style:{zIndex:2},className:"md:text-xs"})]}):s.jsx("div",{className:`${u}`,children:s.jsxs(j,{onClick:L,disabled:!a,className:"inline-flex items-center gap-2 px-3 py-2 bg-gray-900 hover:bg-gray-700 text-gray-100  rounded-md transition-colors text-sm cursor-pointer",children:[s.jsx(O,{size:14,className:"text-gray-100"}),a?s.jsx("span",{children:a}):s.jsx(b,{className:"w-4 h-4"})]})})})},V=()=>{const[e,i]=l.useState(null),[d,p]=l.useState(""),[x,a]=l.useState(!0),[u,t]=l.useState(!1);l.useEffect(()=>{const r=M("clip-data",o=>{i(o.payload),a(!1),o.payload.suggested_category&&!d&&p(o.payload.suggested_category)});return()=>{r.then(o=>o())}},[]);const c=async()=>{t(!0);try{await C("submit_clip",{userCategory:d.trim()||(e==null?void 0:e.suggested_category)||"Other",clipJson:JSON.stringify(e==null?void 0:e.clip)})}catch(r){console.error("Failed to save clip:",r),alert("Failed to save clip: "+r)}finally{t(!1)}},h=async()=>{try{await C("close_toolbar_window")}catch(r){console.error("Failed to close window:",r)}},m=r=>{r.key==="Enter"&&!r.shiftKey?(r.preventDefault(),c()):r.key==="Escape"&&h()};return s.jsxs("div",{className:"min-h-screen w-full flex flex-row items-center gap-2 px-1 toolbar-container",children:[s.jsx(T,{value:d,onChange:r=>p(r),onKeyDown:m,placeholder:(e==null?void 0:e.suggested_category)||"Enter category...",categories:R,aiSuggestion:e==null?void 0:e.suggested_category}),s.jsx(j,{variant:"ghost",onClick:h,disabled:u,size:"sm",className:"hover:bg-gray-200",children:s.jsx(B,{})}),s.jsx(j,{onClick:c,disabled:u||!(e!=null&&e.suggested_category),variant:"ghost",className:"hover:bg-gray-200",size:"sm",children:u?s.jsx(b,{}):s.jsx(F,{})})]})},q=S.createRoot(document.getElementById("root"));q.render(s.jsx(K.StrictMode,{children:s.jsx(V,{})}));
